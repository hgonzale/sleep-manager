[tox]
requires =
    tox>=4.14.0
    tox-uv>=1.11.0
env_list =
    unit
    integration
    all
    lint
    typecheck
    fmt

[testenv]
description = Run the test suite with the default interpreter
runner = uv-venv-runner
dependency_groups = dev
commands =
    pytest -v {posargs:tests}

[testenv:unit]
description = Run the unit tests for sleeper and waker
runner = uv-venv-runner
dependency_groups = dev
commands =
    pytest -m unit -v {posargs:tests/test_sleeper.py tests/test_waker.py}

[testenv:integration]
description = Run the integration tests
runner = uv-venv-runner
dependency_groups = dev
commands =
    pytest -m integration -v {posargs:tests/test_integration.py}

[testenv:all]
description = Run every test in the suite (mirrors the default env)
runner = uv-venv-runner
dependency_groups = dev
commands =
    pytest -v {posargs:tests}

[testenv:lint]
description = Run Ruff lint checks
runner = uv-venv-runner
dependency_groups = dev
commands =
    ruff check {posargs:.}

[testenv:typecheck]
description = Run mypy type checks
runner = uv-venv-runner
dependency_groups = dev
commands =
    mypy {posargs:sleep_manager tests}

[testenv:fmt]
description = Run Ruff formatting (non-checking)
runner = uv-venv-runner
skip_install = true
commands =
    ruff format {posargs:.}
